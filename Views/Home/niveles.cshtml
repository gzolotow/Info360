@{
    ViewData["Title"] = "Niveles";

    /* L√≥gica de niveles completados (recibida del controlador) */
    bool nivel1Completado = ViewBag.Nivel1Completado ?? false;
    bool nivel2Completado = ViewBag.Nivel2Completado ?? false;
}
<body>
    <header>
        <!-- Nav inicio -->
        <nav class="navbar fixed-top">
            <div class="container-fluid">
                <!-- Logo -->

                <img class="LogoHeader" src="/img/logo.png" alt="Ecoplay">

                <!-- Termina Logo -->

                <!-- ‚úÖ Corregido: sin href -->
                <a class="foto" asp-controller="Home" asp-action="Perfil">
                    <img src="/img/default.png" alt="Inicio">
                </a>

                <!-- Bot√≥n para abrir el men√∫ -->
                <button class="Menu" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar"
                    aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
                    <img src="/img/menu.png" alt="Abrir men√∫">
                </button>

                <!-- Offcanvas -->
                <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
                    <div class="offcanvas-body d-flex flex-column justify-content-between">
                        <ul class="navbar-nav flex-grow-1 pe-3">
                          <li class="nav-item">
                                <!-- ‚úÖ Corregido -->
                                <a class="Inicio" asp-controller="Home" asp-action="Home">
                                    <img class="casa" src="/img/Inicio.png" alt="Inicio">
                                </a>
                                <h4>Inicio</h4>
                            </li>

                            <li class="nav-item">
                                <!-- ‚úÖ Corregido -->
                                <a class="perfil" asp-controller="Home" asp-action="Perfil">
                                    <img class="perfil" src="/img/perfil.png" alt="Perfil">
                                </a>
                                <h4>Perfil</h4>
                            </li>

                            <button class="btn-submenu" type="button" data-bs-toggle="offcanvas"
                                data-bs-target="#offcanvasConfig" aria-controls="offcanvasConfig">
                                <img class="config" src="/img/config.png" alt="Configuraci√≥n">
                            </button>
                            <h4>Configuraci√≥n</h4>

                            <button type="button" class="btn-offcanvas-cerrar" data-bs-dismiss="offcanvas"
                                aria-label="Cerrar">
                                <img class="Cerrar" src="/img/cerrarMenu.png" alt="Cerrar men√∫">
                                <h4>Cerrar</h4>
                                
                            </button>

                        </ul>
                    </div>
                </div>

                <!-- üß© SUBOVERLAY de CONFIGURACI√ìN -->
                <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasConfig" aria-labelledby="offcanvasConfigLabel">
                    <div class="offcanvas-header"></div>
                    <div class="offcanvas-body config-body text-center">

                        <!-- Opci√≥n M√∫sica -->
                        <div class="config-item">
                            <img src="/img/musica.png" alt="M√∫sica" class="musica">
                            <a href="#"><img src="/img/check.png" alt="Activado" class="config-icon"></a>
                        </div>

                        <!-- Opci√≥n Volumen -->
                        <div class="config-item">
                            <img src="/img/volumen.png" alt="Volumen" class="volumen">

                            <!-- Slider funcional -->
                            <input type="range" id="volumeSlider" min="0" max="100" value="80" class="rango">

                            <!-- Texto din√°mico -->
                            <span id="volumeLabel" class="rango">Alto</span>

                            <!-- Bot√≥n para abrir el offcanvas -->
                            <button class="btn-cerrar"d type="button" data-bs-toggle="offcanvas"
                                data-bs-target="#offcanvasCenter" aria-controls="offcanvasCenter">
                                terminos y condiciones
                            </button>

                            <!-- Bot√≥n Salir -->
                               <button type="button"  data-bs-dismiss="offcanvas" aria-label="Close">
                                <img class = "close" src="/img/cerrarOverlay.png" alt="">
                               <button class = "close" type="button"  data-bs-dismiss="offcanvas" aria-label="Close">
                                <img src="/img/cerrarOverlay.png" alt="">
                            </button>
                        </div>
                    </div>
                </div>

                <!-- üéµ Script de volumen -->
                <script>
                    document.addEventListener("DOMContentLoaded", () => {
                        const slider = document.getElementById('volumeSlider');
                        const label = document.getElementById('volumeLabel');

                        if (slider && label) {
                            slider.addEventListener('input', () => {
                                const value = slider.value;

                                if (value >= 70) {
                                    label.textContent = 'Alto';
                                } else if (value >= 40) {
                                    label.textContent = 'Medio';
                                } else if (value > 0) {
                                    label.textContent = 'Bajo';
                                } else {
                                    label.textContent = 'Mute';
                                }
                            });
                        }
                    });
                </script>
            </div>
        </nav>
    </header>
    <main> 
        <div class="niveles-container">

    <!-- Bot√≥n Volver -->
  <section class="boton">
            <a asp-controller="Home" asp-action="Home" class="col1 row1">
                <img src="/img/salir.png" alt="salir">
            </a>
        </section>

    <!-- Bot√≥n Misiones -->
    <a href="@Url.Action("Misiones", "Home")" class="niveles-btn-misiones">
        Misiones
    </a>

    <!-- L√≠neas Conectoras -->
    <svg class="niveles-conexiones-svg" viewBox="0 0 100 100" preserveAspectRatio="none">
        <!-- Tutorial a Nivel 1 -->
        <path d="M 15 65 C 15 50, 25 35, 40 35" 
              stroke="black" 
              stroke-width="3" 
              fill="none" 
              vector-effect="non-scaling-stroke" />

        <!-- Nivel 1 a Nivel 2 -->
        <path d="M 40 35 C 55 35, 50 65, 65 65" 
              stroke="black" 
              stroke-width="3" 
              fill="none" 
              vector-effect="non-scaling-stroke" />

        <!-- Nivel 2 a Nivel 3 -->
        <path d="M 65 65 C 80 65, 75 35, 90 35" 
              stroke="black" 
              stroke-width="3" 
              fill="none" 
              vector-effect="non-scaling-stroke" />
    </svg>

    <!-- NODO: Tutorial (Siempre disponible) -->
    <a href="javascript:void(0)" onclick="abrirOverlay()" class="niveles-nodo niveles-nodo-tutorial">
        Tutorial
    </a>

    <!-- NODO: Nivel 1 (Siempre disponible) -->
    <a href="@Url.Action("Nivel1", "Home")" class="niveles-nodo niveles-nodo-1">
        NIVEL 1
    </a>

    <!-- NODO: Nivel 2 -->
    @if (nivel1Completado)
    {
        <a href="/Nivel2" class="niveles-nodo niveles-nodo-2">
            NIVEL 2
        </a>
    }
    else
    {
        <div class="niveles-nodo niveles-nodo-2 niveles-bloqueado">
            <span class="niveles-candado">&#128274;</span>
            NIVEL 2
        </div>
    }

    <!-- NODO: Nivel 3 -->
    @if (nivel2Completado)
    {
        <a href="/Nivel3" class="niveles-nodo niveles-nodo-3">
            NIVEL 3
        </a>
    }
    else
    {
        <div class="niveles-nodo niveles-nodo-3 niveles-bloqueado">
            <span class="niveles-candado">&#128274;</span>
            NIVEL 3
        </div>
    }

</div>

<!-- Overlay del Tutorial -->
<div id="tutorial-overlay" class="overlay" style="display:none;">
    <div class="overlay-content">
        <button class="overlay-close" onclick="cerrarOverlay()"><p> X </p></button>
        <img src="/img/tutorial.png" alt="Tutorial Basura" class="overlay-img" />
    </div>
</div>

<!-- Scripts -->
<script>
    function abrirOverlay() {
        document.getElementById('tutorial-overlay').style.display = 'flex';
    }
    function cerrarOverlay() {
        document.getElementById('tutorial-overlay').style.display = 'none';
    }
</script>
  <!-- Offcanvas centrado -->
                <div class="offcanvas offcanvas-center" tabindex="-1" id="offcanvasCenter" aria-labelledby="offcanvasCenterLabel">
                    <div class="offcanvas-header">
                        <h5 class="offcanvas-title" id="offcanvasCenterLabel">terminos y condiciones</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Cerrar"></button>
                    </div>
                    <div class="offcanvas-body">
                        <p>
                            1. Aceptaci√≥n de los t√©rminos...
                            <!-- (Texto de t√©rminos y condiciones) -->
                        </p>
                        <button class="btn btn-outline-secondary" data-bs-dismiss="offcanvas">Cerrar</button>
                        <button class="btn" data-bs-dismiss="offcanvas">Cerrar</button>
                    </div>
                </div>
    </main>
</body>