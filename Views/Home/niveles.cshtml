@{
    ViewData["Title"] = "Niveles - EcoPlay";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link rel="stylesheet" href="~/css/niveles.css" />

<div class="niveles-container">
    <div class="niveles-layout">
        <a href="/Home/Tutorial" class="niveles-btn tutorial-btn" data-nivel="tutorial">Tutorial</a>
        <a href="/Home/Nivel1" class="niveles-btn nivel1-btn" data-nivel="1">Nivel 1</a>
        <a href="#" class="niveles-btn nivel2-btn bloqueado" data-nivel="2">Nivel 2 üîí</a>
        <a href="#" class="niveles-btn nivel3-btn bloqueado" data-nivel="3">Nivel 3 üîí</a>
    </div>

    <button class="niveles-volver" onclick="window.history.back();">‚Üê</button>
</div>

@section Scripts {
<script>
document.addEventListener("DOMContentLoaded", () => {
    const completado = JSON.parse(localStorage.getItem("nivelesCompletados")) || [];

    const btnNivel2 = document.querySelector('.nivel2-btn');
    const btnNivel3 = document.querySelector('.nivel3-btn');

    if (completado.includes(1)) {
        btnNivel2.classList.remove('bloqueado');
        btnNivel2.textContent = 'Nivel 2';
        btnNivel2.setAttribute('href', '/Home/Nivel2');
    }
    if (completado.includes(2)) {
        btnNivel3.classList.remove('bloqueado');
        btnNivel3.textContent = 'Nivel 3';
        btnNivel3.setAttribute('href', '/Home/Nivel3');
    }

    document.querySelectorAll(".niveles-btn").forEach(btn => {
        btn.addEventListener("click", e => {
            const nivel = btn.getAttribute("data-nivel");
            if (btn.classList.contains("bloqueado")) {
                e.preventDefault();
                alert("‚ö†Ô∏è Debes completar el nivel anterior primero.");
                return;
            }
            switch (nivel) {
                case "tutorial": window.location.href = "/Home/Tutorial"; break;
                case "1": window.location.href = "/Home/Nivel1"; break;
                case "2": window.location.href = "/Home/Nivel2"; break;
                case "3": window.location.href = "/Home/Nivel3"; break;
            }
        });
    });
});
</script>
}
